sequenceDiagram
    participant C as Cliente
    participant S as Servidor

    Note over C,S: Conexión establecida - transferencia de datos
    C->>S: FIN=1, seq=x
    Note over C: Estado: FIN_WAIT_1
    Note over S: Estado: CLOSE_WAIT
    S->>C: ACK=1, ack=x+1
    Note over C: Estado: FIN_WAIT_2
    Note over S: Aplicación termina, cierra socket
    S->>C: FIN=1, ACK=1, seq=y, ack=x+1
    Note over S: Estado: LAST_ACK
    Note over C: Estado: TIME_WAIT
    C->>S: ACK=1, seq=x+1, ack=y+1
    Note over S: Estado: CLOSED
    Note over C: Espera 2*MSL (TIME_WAIT)
    Note over C: Estado: CLOSED
